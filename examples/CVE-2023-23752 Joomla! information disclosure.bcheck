metadata:
    language: v1-beta
    name: "CVE-2023-23752 Joomla! information disclosure"
    description: "Tests for Joomla CVE-2023-23752"
    author: "jcai"

run for each:
    # you could add more values to this list to make the check repeat
    potential_path =
        "/api/index.php/v1/config/application?public=true"

given host then
    send request called check:
        method: "GET"
        path: {potential_path}

    if "password" in {check.response.body} then
        report issue:
            severity: high
            confidence: certain
            detail: `Found  at {potential_path}.`
            remediation: "Upgrade to new version."
    end if
